<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shanghai 5-Day Itinerary</title>
  <style>
    :root{--accent:#2883c6;--muted:#6b7280}
    body{font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; padding:16px; background:#f7fafc; color:#0f172a}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between}
    h1{font-size:18px;margin:0}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{background:var(--accent);color:white;border:none;padding:8px 10px;border-radius:8px;font-size:14px}
    button.ghost{background:white;color:var(--accent);border:1px solid rgba(40,131,198,.15)}
    main{margin-top:12px}

    /* Table */
    .table-wrap{overflow:auto;background:white;border-radius:10px;box-shadow:0 1px 2px rgba(2,6,23,.06);padding:12px}
    table{width:100%;border-collapse:collapse;font-size:13px}
    thead th{position:sticky;top:0;background:linear-gradient(90deg,var(--accent),#1f6fa8);color:white;padding:10px;text-align:left}
    tbody td{padding:10px;border-bottom:1px solid #eef2f7;vertical-align:top}

    /* Card view for mobile */
    .cards{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
    .card{background:white;padding:12px;border-radius:10px;box-shadow:0 1px 2px rgba(2,6,23,.06)}
    .card h3{margin:0 0 6px 0;font-size:15px}
    .muted{color:var(--muted);font-size:13px}

    /* Responsive */
    @media(min-width:720px){
      .cards{grid-template-columns:repeat(2,1fr)}
      thead th{font-size:14px}
    }
    .note{font-size:13px;color:var(--muted);margin-top:8px}
  </style>

  <!-- SheetJS (XLSX) for Excel export -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <!-- jsPDF + autoTable for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
  <header>
    <h1>üèô Shanghai 5-Day Itinerary <small style="font-weight:400; color:var(--muted); display:block; font-size:12px">29 Oct ‚Äì 2 Nov</small></h1>

    <div class="controls">
      <button id="btnToggleView" class="ghost">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)</button>
      <button id="btnDownloadXLS">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel</button>
      <button id="btnDownloadPDF">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
      <button id="btnDownloadCSV" class="ghost">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV</button>
      <button id="btnPrint" class="ghost">‡∏û‡∏¥‡∏°‡∏û‡πå / Print</button>
    </div>
  </header>

  <main>
    <div class="table-wrap" id="tableWrap">
      <table id="itineraryTable" aria-label="Shanghai itinerary">
        <thead>
          <tr>
            <th style="min-width:90px">Day</th>
            <th style="min-width:220px">Main Activities (TH/EN)</th>
            <th style="min-width:180px">Highlights</th>
            <th style="min-width:220px">Transport & Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Day 1 (29 Oct)</td>
            <td>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡πÄ‡∏ã‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏Æ‡πâ / Arrival in Shanghai<br>‡∏û‡∏±‡∏Å Jinjiang Inn / Check-in Hotel</td>
            <td>‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô, ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô‡∏£‡∏≠‡∏ö‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° Jinjiang / Relax nearby hotel</td>
            <td>BKK ‚úà PVG (01:55‚Äì06:55)<br>Metro Line 2 ‚Üí People‚Äôs Square ‚Üí Jinjiang Inn</td>
          </tr>
          <tr>
            <td>Day 2 (30 Oct)</td>
            <td>‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß Shanghai Disneyland / Visit Shanghai Disneyland</td>
            <td>‡∏î‡∏¥‡∏™‡∏ô‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏ô‡∏î‡πå‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô / Full day at Disneyland</td>
            <td>Metro Line 2 ‚Üí Disneyland<br>‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ~1 ‡∏ä‡∏°.</td>
          </tr>
          <tr>
            <td>Day 3 (31 Oct)</td>
            <td>‡∏ß‡∏±‡∏î Jing‚Äôan, ‡∏ñ‡∏ô‡∏ô Wukang / Jing‚Äôan Temple, Wukang Rd Caf√© Street</td>
            <td>‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà Bear Lala, RAC Coffee / Cute caf√© & local vibes</td>
            <td>Metro Line 2 ‚Üí Jing‚Äôan Temple / Line 10 ‚Üí Wukang Rd</td>
          </tr>
          <tr>
            <td>Day 4 (1 Nov)</td>
            <td>People‚Äôs Square, Nanjing Rd, Jade Buddha Temple / ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á ‡πÑ‡∏´‡∏ß‡πâ‡∏û‡∏£‡∏∞</td>
            <td>Jade Buddha Temple, ‡∏ä‡πâ‡∏≠‡∏õ‡∏ó‡∏µ‡πà Nanjing Rd / Spiritual & shopping</td>
            <td>Metro Line 7 ‚Üí Changshou Rd ‚Üí Jade Buddha Temple</td>
          </tr>
          <tr>
            <td>Day 5 (2 Nov)</td>
            <td>The Bund, Oriental Pearl Tower, ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á / Photo day & return flight</td>
            <td>The Bund, ‡∏´‡∏≠‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å, ‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡∏ó‡∏≠‡∏á / Iconic Shanghai shots</td>
            <td>Metro Line 2 ‚Üí Lujiazui ‚Üí The Bund<br>‡∏Å‡∏•‡∏±‡∏ö PVG ‡πÄ‡∏ß‡∏•‡∏≤ 21:00</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Card view for mobile -->
    <div class="cards" id="cards" style="display:none">
      <!-- Each card matches a row above -->
      <div class="card">
        <h3>Day 1 (29 Oct)</h3>
        <div class="muted">‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡πÄ‡∏ã‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏Æ‡πâ / Arrival in Shanghai</div>
        <p>‡∏û‡∏±‡∏Å Jinjiang Inn / Check-in Hotel</p>
        <p class="muted">Highlights: ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô, ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô‡∏£‡∏≠‡∏ö‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° Jinjiang</p>
        <p class="muted">Transport: BKK ‚úà PVG (01:55‚Äì06:55) ¬∑ Metro Line 2 ‚Üí People‚Äôs Square ‚Üí Jinjiang Inn</p>
      </div>

      <div class="card">
        <h3>Day 2 (30 Oct)</h3>
        <div class="muted">‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß Shanghai Disneyland / Visit Shanghai Disneyland</div>
        <p class="muted">Highlights: ‡∏î‡∏¥‡∏™‡∏ô‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏ô‡∏î‡πå‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô</p>
        <p class="muted">Transport: Metro Line 2 ‚Üí Disneyland ¬∑ ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ~1 ‡∏ä‡∏°.</p>
      </div>

      <div class="card">
        <h3>Day 3 (31 Oct)</h3>
        <div class="muted">‡∏ß‡∏±‡∏î Jing‚Äôan, ‡∏ñ‡∏ô‡∏ô Wukang / Jing‚Äôan Temple, Wukang Rd Caf√© Street</div>
        <p class="muted">Highlights: ‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà Bear Lala, RAC Coffee</p>
        <p class="muted">Transport: Metro Line 2 ‚Üí Jing‚Äôan Temple / Line 10 ‚Üí Wukang Rd</p>
      </div>

      <div class="card">
        <h3>Day 4 (1 Nov)</h3>
        <div class="muted">People‚Äôs Square, Nanjing Rd, Jade Buddha Temple</div>
        <p class="muted">Highlights: Jade Buddha Temple, ‡∏ä‡πâ‡∏≠‡∏õ‡∏ó‡∏µ‡πà Nanjing Rd</p>
        <p class="muted">Transport: Metro Line 7 ‚Üí Changshou Rd ‚Üí Jade Buddha Temple</p>
      </div>

      <div class="card">
        <h3>Day 5 (2 Nov)</h3>
        <div class="muted">The Bund, Oriental Pearl Tower, ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á</div>
        <p class="muted">Highlights: The Bund, ‡∏´‡∏≠‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å, ‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡∏ó‡∏≠‡∏á</p>
        <p class="muted">Transport: Metro Line 2 ‚Üí Lujiazui ‚Üí The Bund ¬∑ ‡∏Å‡∏•‡∏±‡∏ö PVG ‡πÄ‡∏ß‡∏•‡∏≤ 21:00</p>
      </div>
    </div>

    <p class="note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Å‡∏î <strong>‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏ö‡∏ö mobile-friendly. ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÑ‡∏´‡∏ô).</p>
  </main>

  <script>
    // Toggle view
    const btnToggle = document.getElementById('btnToggleView');
    const tableWrap = document.getElementById('tableWrap');
    const cards = document.getElementById('cards');
    let isCard = false;
    btnToggle.addEventListener('click', ()=>{
      isCard = !isCard;
      if(isCard){
        tableWrap.style.display = 'none';
        cards.style.display = 'grid';
        btnToggle.textContent = '‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á (Desktop)';
      }else{
        tableWrap.style.display = '';
        cards.style.display = 'none';
        btnToggle.textContent = '‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)';
      }
    });

    // Excel (XLSX) export using SheetJS
    document.getElementById('btnDownloadXLS').addEventListener('click', ()=>{
      try{
        const table = document.getElementById('itineraryTable');
        const wb = XLSX.utils.table_to_book(table, {sheet:"Itinerary"});
        XLSX.writeFile(wb, 'Shanghai_5Days_Itinerary.xlsx');
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Excel: '+err.message);
      }
    });

    // CSV export fallback
    document.getElementById('btnDownloadCSV').addEventListener('click', ()=>{
      try{
        const table = document.getElementById('itineraryTable');
        const csv = XLSX.utils.sheet_to_csv( XLSX.utils.table_to_sheet(table) );
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'Shanghai_5Days_Itinerary.csv'; a.click(); URL.revokeObjectURL(url);
      }catch(err){ alert('Error creating CSV: '+err.message); }
    });

    // PDF export using jsPDF + autoTable
    document.getElementById('btnDownloadPDF').addEventListener('click', async ()=>{
      try{
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({orientation:'landscape',unit:'pt',format:'a4'});
        doc.setFontSize(14);
        doc.text('Shanghai 5-Day Itinerary (29 Oct ‚Äì 2 Nov)', 40, 40);
        doc.autoTable({
          html: '#itineraryTable',
          startY: 60,
          headStyles: {fillColor: [40,131,198]},
          styles: {fontSize:9,cellPadding:6,overflow:'linebreak'},
          theme: 'grid',
          columnStyles: {0:{cellWidth:70},1:{cellWidth:220},2:{cellWidth:180},3:{cellWidth:220}}
        });
        doc.save('Shanghai_5Days_Itinerary.pdf');
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF: '+err.message);
      }
    });

    // Print
    document.getElementById('btnPrint').addEventListener('click', ()=>{
      window.print();
    });

    // Accessibility: allow opening links with Enter on buttons
    document.querySelectorAll('button').forEach(b=>b.addEventListener('keyup', e=>{ if(e.key==='Enter') b.click(); }));
  </script>
</body>
</html>
